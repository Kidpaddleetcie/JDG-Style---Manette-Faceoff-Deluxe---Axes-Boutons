<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JDG Style - Manette Faceoff Deluxe - Axes + Boutons</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: rgb(0, 255, 0);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 20px;
      min-height: 100vh;
    }

 g {
  fill: #3b3c3c;
  stroke: #646464;
  stroke-width: 2px;
  stroke-linejoin: round;
 filter: 
    drop-shadow(-1px -1px 0px #313131) 
    drop-shadow(2px -1px 0px #313131) 
    drop-shadow(2px 2px 0px #313131)
    drop-shadow(-1px 2px 0px #313131);
}
   main{
    width: 300px;
 height: 150px;
 resize: both;
 overflow: auto;
 border: 1px dashed #aaa;
}

svg {
 width: 95%;
 height: 95%;
}

    .pressed {
      fill: #ff7300;
      stroke: #ffd000;
  stroke-width: 2px;
  stroke-linejoin: round;
      filter: 
    drop-shadow(-1px -1px 0px #924200) 
    drop-shadow(1px -1px 0px #924200) 
    drop-shadow(1px 1px 0px #924200)
    drop-shadow(-1px 1px 0px #924200);
    transform: rotateX(5deg);

    }

  </style>

</head>
<body>
<main>
<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="338.181px" height="148.177px" viewBox="0 0 338.181 148.177" enable-background="new 0 0 338.181 148.177"
	 xml:space="preserve">
<g>
	<path fill="#3C3C3B" d="M66.793,118.569c-0.017,0.002-0.034,0.003-0.05,0.005c-0.004,0.021-0.007,0.042-0.011,0.063L66.793,118.569
		z"/>
	<path fill="#3C3C3B" d="M67.57,75.515c-1.032-6.581,0.373-13.255-0.743-19.833c-7.401,0-14.802,0-22.203,0
		c-1.118,6.578,0.292,13.25-0.744,19.83c-6.42,0.058-12.839,0.115-19.259,0.172c-0.651,7.609-0.651,15.218,0,22.826
		c6.42,0.057,12.84,0.113,19.26,0.17c1.085,6.599-0.494,13.308,0.828,19.895c7.345,0.853,14.688,0.853,22.033,0
		c1.324-6.586-0.26-13.295,0.829-19.892c6.42-0.058,12.839-0.115,19.259-0.173c0.651-7.608,0.651-15.217,0-22.826
		C80.411,75.627,73.991,75.571,67.57,75.515z"/>
	<path fill="#3C3C3B" d="M44.721,118.637c-0.004-0.021-0.007-0.041-0.011-0.063c-0.017-0.002-0.033-0.003-0.05-0.005L44.721,118.637
		z"/>
	<path id="btn-b" fill="#3C3C3B" d="M239.216,89.294c-1.815-0.327-3.633-0.313-5.448,0.075c-6.812,1.332-10.226,5.844-11.627,12.313
		c-1.12,5.17,1.034,9.49,4.286,12.912c2.561,2.693,5.629,4.007,8.891,4.28c1.093,0.233,2.227,0.363,3.4,0.353
		c8.307-0.078,14.881-6.736,14.813-15C253.463,96.044,247.242,89.623,239.216,89.294z"/>
	<path id="btn-a" fill="#3C3C3B" d="M282.875,89.291c-2.085-0.371-4.166-0.403-6.241,0.246c-4.344,1.092-7.351,3.419-9.296,7.753
		c-3.669,8.173-0.785,16.591,7.559,20.368c0.886,0.4,1.832,0.686,2.813,0.864c1.452,0.465,2.996,0.724,4.601,0.724
		c8.529-0.002,15.006-6.609,14.932-15.234C297.172,95.94,290.858,89.542,282.875,89.291z"/>
	<path fill="#3C3C3B" d="M144.034,100.078c-0.09,0.002-0.18,0-0.27,0.002c-7.866-0.94-15.799-0.813-23.668-0.067
		c-2.618,0.247-4.357,2.503-4.133,5.415c0.158,2.057,1.191,3.159,2.658,3.693c0.779,0.618,1.811,0.982,3.099,1.008
		c7.63,0.15,15.266,0.133,22.897,0.05c3.203-0.035,4.946-2.103,4.897-5.108C149.461,101.775,147.516,99.997,144.034,100.078z"/>
	<path fill="#FF000000" d="M188.994,100.076L188.994,100.076c-0.146-0.026-0.281-0.069-0.434-0.084
		c-7.772-0.759-15.601-0.746-23.369-0.008c-2.654,0.252-4.381,2.467-4.23,5.353c0.105,2.042,1.098,3.173,2.536,3.734
		c0.785,0.643,1.834,1.018,3.141,1.046c7.632,0.166,15.269,0.12,22.904,0.056c3.236-0.027,4.975-2.146,4.937-5.085
		C194.435,101.861,192.498,99.994,188.994,100.076z"/>
	<path id="btn-select" fill="#3C3C3B" d="M144.034,100.078c-0.09,0.002-0.18,0-0.27,0.002c-7.866-0.94-15.799-0.813-23.668-0.067
		c-2.618,0.247-4.357,2.503-4.133,5.415c0.158,2.057,1.191,3.159,2.658,3.693c0.779,0.618,1.811,0.982,3.099,1.008
		c7.63,0.15,15.266,0.133,22.897,0.05c3.203-0.035,4.946-2.103,4.897-5.108C149.461,101.775,147.516,99.997,144.034,100.078z"/>
	<path id="btn-start" fill="#3C3C3B" d="M188.994,100.076L188.994,100.076c-0.146-0.026-0.281-0.069-0.434-0.084
		c-7.772-0.759-15.601-0.746-23.369-0.008c-2.654,0.252-4.381,2.467-4.23,5.353c0.105,2.042,1.098,3.173,2.536,3.734
		c0.785,0.643,1.834,1.018,3.141,1.046c7.632,0.166,15.269,0.12,22.904,0.056c3.236-0.027,4.975-2.146,4.937-5.085
		C194.435,101.861,192.498,99.994,188.994,100.076z"/>
	<g>
		<path id="btn-down" fill="#3C3C3B" d="M44.709,118.574c7.345,0.852,14.688,0.852,22.033,0c1.324-6.586-0.26-13.295,0.829-19.893H43.882
			C44.967,105.279,43.388,111.988,44.709,118.574z"/>
		<path id="btn-up" fill="#3C3C3B" d="M66.828,55.681c-7.401,0-14.802,0-22.203,0c-1.118,6.578,0.292,13.25-0.744,19.83H67.57
			C66.539,68.931,67.943,62.258,66.828,55.681z"/>
		<path id="btn-left" fill="#3C3C3B" d="M24.622,75.684c-0.651,7.609-0.651,15.217,0,22.826c6.419,0.057,12.839,0.113,19.259,0.17V75.512
			C37.46,75.568,31.041,75.627,24.622,75.684z"/>
		<path id="btn-right" fill="#3C3C3B" d="M86.831,75.684c-6.419-0.057-12.839-0.113-19.259-0.17v23.168c6.42-0.057,12.839-0.115,19.259-0.172
			C87.481,90.9,87.481,83.293,86.831,75.684z"/>
		<rect x="67.57" y="75.512" fill="#E30613" width="0.002" height="0.002"/>
		<rect x="43.88" y="98.68" fill="#E30613" width="0.002" height="0.002"/>
	</g>
</g>
</main>
  <script>

    let gamepadIndex = null;

    const buttonMapping = {
      "btn-a": 2,      // A
      "btn-b": 1,      // B
      "btn-select": 8, // –
      "btn-start": 9   // +
    };

    const directionIds = {
      "btn-up": false,
      "btn-down": false,
      "btn-left": false,
      "btn-right": false
    };

    window.addEventListener("gamepadconnected", (e) => {
      gamepadIndex = e.gamepad.index;
      console.log("Manette connectée :", e.gamepad.id);
      updateLoop();
    });

    window.addEventListener("gamepaddisconnected", () => {
      console.log("Manette déconnectée");
      gamepadIndex = null;
      document.getElementById('input-log').textContent = "Manette déconnectée";
    });

    function updateLoop() {
      if (gamepadIndex === null) return;

      const gp = navigator.getGamepads()[gamepadIndex];
      if (!gp) return;

      let pressedNames = [];

      // GESTION DES BOUTONS
      for (const [id, index] of Object.entries(buttonMapping)) {
        const btn = document.getElementById(id);
        const pressed = gp.buttons[index]?.pressed;
        const name = id.replace("btn-", "").toUpperCase();

        if (pressed) {
          if (btn) btn.classList.add("pressed");
          pressedNames.push(name);
        } else {
          if (btn) btn.classList.remove("pressed");
        }
      }

      // GESTION DES DIRECTIONS PAR LES AXES (D-PAD)
      const threshold = 0.3;

      const y = gp.axes[9];

      directionIds["btn-left"]  = y === 0.7142857142857142 || y === 0.4285714285714286 || y === 1;
      directionIds["btn-down"]  = y === 0.1428571428571428 || y === 0.4285714285714286 || y === -0.1428571428571429;
      directionIds["btn-right"] = y === -0.4285714285714286 || y === -0.7142857142857143 || y === -0.1428571428571429;
      directionIds["btn-up"]    = y === -1 || y === 1 || y === -0.7142857142857143;


      for (const [id, isPressed] of Object.entries(directionIds)) {
        const btn = document.getElementById(id);
        const name = id.replace("btn-", "").toUpperCase();
        if (isPressed) {
          btn.classList.add("pressed");
          pressedNames.push(name);
        } else {
          btn.classList.remove("pressed");
        }
      }



      requestAnimationFrame(updateLoop);
    }
  </script>
</body>
</html>
